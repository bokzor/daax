CREATE TABLE article (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, img VARCHAR(255) DEFAULT 'default.jpg' NOT NULL, is_publish TINYINT(1) DEFAULT '1' NOT NULL, category_id BIGINT, prix FLOAT(18, 2), description TEXT, temps_prepa BIGINT, count BIGINT DEFAULT 0, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, slug VARCHAR(255), UNIQUE INDEX article_sluggable_idx (slug), INDEX category_id_idx (category_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE article_commande (id BIGINT AUTO_INCREMENT, article_id BIGINT, commande_id BIGINT, count BIGINT DEFAULT 1, prix FLOAT(18, 2) DEFAULT 0, INDEX article_id_idx (article_id), INDEX commande_id_idx (commande_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE article_commande_supplement (article_commande_id BIGINT, supplement_id BIGINT, PRIMARY KEY(article_commande_id, supplement_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE article_element (article_id BIGINT, element_id BIGINT, a_deduire FLOAT(18, 2), PRIMARY KEY(article_id, element_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE category (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL UNIQUE, img VARCHAR(255) DEFAULT 'default.jpg' NOT NULL, father_id BIGINT, is_publish TINYINT(1) DEFAULT '1' NOT NULL, slug VARCHAR(255), root_id BIGINT, lft INT, rgt INT, level SMALLINT, UNIQUE INDEX category_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE category_imprimante (category_id BIGINT, imprimante_id BIGINT, PRIMARY KEY(category_id, imprimante_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE cloture (id BIGINT AUTO_INCREMENT, nb_transaction_cash BIGINT DEFAULT 0, nb_transaction_cb BIGINT DEFAULT 0, nb_transaction_ecb BIGINT DEFAULT 0, total_transaction_cash BIGINT DEFAULT 0, total_transaction_cb BIGINT DEFAULT 0, total_transaction_ecb BIGINT DEFAULT 0, id_user_record BIGINT DEFAULT 0, total_record BIGINT DEFAULT 0, server_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX id_user_record_idx (id_user_record), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE commande (id BIGINT AUTO_INCREMENT, server_id BIGINT NOT NULL, table_id BIGINT NOT NULL, client_id BIGINT, statut_id BIGINT DEFAULT 0 NOT NULL, total_commande FLOAT(18, 2) DEFAULT 0, total_prix_achat FLOAT(18, 2) DEFAULT 0, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX server_id_idx (server_id), INDEX client_id_idx (client_id), INDEX statut_id_idx (statut_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE commandes_transaction (transaction_id BIGINT, commande_id BIGINT, PRIMARY KEY(transaction_id, commande_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE conditionnement (id BIGINT AUTO_INCREMENT, name VARCHAR(255) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE element (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, img VARCHAR(255) DEFAULT 'default.jpg' NOT NULL, is_publish TINYINT(1) DEFAULT '1' NOT NULL, category_id BIGINT, stock_minimum FLOAT(18, 2), stock_actuel FLOAT(18, 2), conditionnement_id BIGINT, fournisseur_id BIGINT, nombre_unite FLOAT(18, 2), prix_achat FLOAT(18, 2), reference VARCHAR(255), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, slug VARCHAR(255), UNIQUE INDEX element_sluggable_idx (slug), INDEX category_id_idx (category_id), INDEX fournisseur_id_idx (fournisseur_id), INDEX conditionnement_id_idx (conditionnement_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE fournisseur (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL UNIQUE, tel VARCHAR(100), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE imprimante (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, description VARCHAR(255), facture TINYINT(1) DEFAULT '0', slug VARCHAR(255), UNIQUE INDEX imprimante_sluggable_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE plan_table (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL UNIQUE, description TEXT, visible TINYINT(1) DEFAULT '0', width BIGINT DEFAULT 1024, height BIGINT DEFAULT 689, background_id BIGINT, INDEX background_id_idx (background_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE plan_table_image (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, img VARCHAR(255) NOT NULL, category_id BIGINT NOT NULL, INDEX category_id_idx (category_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE plan_table_image_category (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE plan_table_object (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, description TEXT, visible TINYINT(1) DEFAULT '0', width BIGINT DEFAULT 1024, height BIGINT DEFAULT 689, rotation BIGINT, statut VARCHAR(100), plantable_id BIGINT, x BIGINT, y BIGINT, locked TINYINT(1) DEFAULT '0', zindex BIGINT DEFAULT 0, image_id BIGINT, elipse TINYINT(1) DEFAULT '0', image_chair_id BIGINT, INDEX image_id_idx (image_id), INDEX image_chair_id_idx (image_chair_id), INDEX plantable_id_idx (plantable_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE publicite (id BIGINT AUTO_INCREMENT, message VARCHAR(255) NOT NULL, selected TINYINT(1) DEFAULT '0', created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE statut_commande (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL UNIQUE, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE supplement (id BIGINT AUTO_INCREMENT, name VARCHAR(100) NOT NULL, fois_prix FLOAT(18, 2) DEFAULT 1, plus_prix FLOAT(18, 2) DEFAULT 0, is_publish BIGINT DEFAULT 1, category_id BIGINT, slug VARCHAR(255), UNIQUE INDEX supplement_sluggable_idx (slug), INDEX category_id_idx (category_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE transaction (id BIGINT AUTO_INCREMENT, server_id BIGINT NOT NULL, client_id BIGINT, cash BIGINT DEFAULT 0, cb BIGINT DEFAULT 0, cashback BIGINT DEFAULT 0, ecb BIGINT DEFAULT 0, statut BIGINT DEFAULT 0, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX server_id_idx (server_id), INDEX client_id_idx (client_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_forgot_password (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id BIGINT AUTO_INCREMENT, user_id BIGINT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user (id BIGINT AUTO_INCREMENT, email_address VARCHAR(255), avatar VARCHAR(255) DEFAULT 'default.png', first_name VARCHAR(30), last_name VARCHAR(30), tel VARCHAR(20), country VARCHAR(30), street VARCHAR(255), postal_code BIGINT, city VARCHAR(255), genre VARCHAR(255), username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, tva VARCHAR(100), date_naissance DATE, credit BIGINT DEFAULT 0, identifiant BIGINT UNIQUE, code INT UNSIGNED UNIQUE, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id BIGINT, group_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
ALTER TABLE article ADD CONSTRAINT article_category_id_category_id FOREIGN KEY (category_id) REFERENCES category(id) ON DELETE CASCADE;
ALTER TABLE article_commande ADD CONSTRAINT article_commande_commande_id_commande_id FOREIGN KEY (commande_id) REFERENCES commande(id) ON DELETE CASCADE;
ALTER TABLE article_commande ADD CONSTRAINT article_commande_article_id_article_id FOREIGN KEY (article_id) REFERENCES article(id) ON DELETE CASCADE;
ALTER TABLE article_commande_supplement ADD CONSTRAINT article_commande_supplement_supplement_id_supplement_id FOREIGN KEY (supplement_id) REFERENCES supplement(id) ON DELETE CASCADE;
ALTER TABLE article_commande_supplement ADD CONSTRAINT aaai FOREIGN KEY (article_commande_id) REFERENCES article_commande(id) ON DELETE CASCADE;
ALTER TABLE article_element ADD CONSTRAINT article_element_element_id_element_id FOREIGN KEY (element_id) REFERENCES element(id) ON DELETE CASCADE;
ALTER TABLE article_element ADD CONSTRAINT article_element_article_id_article_id FOREIGN KEY (article_id) REFERENCES article(id) ON DELETE CASCADE;
ALTER TABLE category_imprimante ADD CONSTRAINT category_imprimante_imprimante_id_imprimante_id FOREIGN KEY (imprimante_id) REFERENCES imprimante(id) ON DELETE CASCADE;
ALTER TABLE category_imprimante ADD CONSTRAINT category_imprimante_category_id_category_id FOREIGN KEY (category_id) REFERENCES category(id) ON DELETE CASCADE;
ALTER TABLE cloture ADD CONSTRAINT cloture_id_user_record_sf_guard_user_id FOREIGN KEY (id_user_record) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE commande ADD CONSTRAINT commande_statut_id_statut_commande_id FOREIGN KEY (statut_id) REFERENCES statut_commande(id);
ALTER TABLE commande ADD CONSTRAINT commande_server_id_sf_guard_user_id FOREIGN KEY (server_id) REFERENCES sf_guard_user(id);
ALTER TABLE commande ADD CONSTRAINT commande_client_id_sf_guard_user_id FOREIGN KEY (client_id) REFERENCES sf_guard_user(id);
ALTER TABLE commandes_transaction ADD CONSTRAINT commandes_transaction_transaction_id_transaction_id FOREIGN KEY (transaction_id) REFERENCES transaction(id) ON DELETE CASCADE;
ALTER TABLE commandes_transaction ADD CONSTRAINT commandes_transaction_commande_id_commande_id FOREIGN KEY (commande_id) REFERENCES commande(id) ON DELETE CASCADE;
ALTER TABLE element ADD CONSTRAINT element_fournisseur_id_fournisseur_id FOREIGN KEY (fournisseur_id) REFERENCES fournisseur(id) ON DELETE CASCADE;
ALTER TABLE element ADD CONSTRAINT element_conditionnement_id_conditionnement_id FOREIGN KEY (conditionnement_id) REFERENCES conditionnement(id) ON DELETE CASCADE;
ALTER TABLE element ADD CONSTRAINT element_category_id_category_id FOREIGN KEY (category_id) REFERENCES category(id) ON DELETE CASCADE;
ALTER TABLE plan_table ADD CONSTRAINT plan_table_background_id_plan_table_image_id FOREIGN KEY (background_id) REFERENCES plan_table_image(id) ON DELETE CASCADE;
ALTER TABLE plan_table_image ADD CONSTRAINT plan_table_image_category_id_plan_table_image_category_id FOREIGN KEY (category_id) REFERENCES plan_table_image_category(id) ON DELETE CASCADE;
ALTER TABLE plan_table_object ADD CONSTRAINT plan_table_object_plantable_id_plan_table_id FOREIGN KEY (plantable_id) REFERENCES plan_table(id) ON DELETE CASCADE;
ALTER TABLE plan_table_object ADD CONSTRAINT plan_table_object_image_id_plan_table_image_id FOREIGN KEY (image_id) REFERENCES plan_table_image(id) ON DELETE CASCADE;
ALTER TABLE plan_table_object ADD CONSTRAINT plan_table_object_image_chair_id_plan_table_image_id FOREIGN KEY (image_chair_id) REFERENCES plan_table_image(id) ON DELETE CASCADE;
ALTER TABLE supplement ADD CONSTRAINT supplement_category_id_category_id FOREIGN KEY (category_id) REFERENCES category(id) ON DELETE CASCADE;
ALTER TABLE transaction ADD CONSTRAINT transaction_server_id_sf_guard_user_id FOREIGN KEY (server_id) REFERENCES sf_guard_user(id);
ALTER TABLE transaction ADD CONSTRAINT transaction_client_id_sf_guard_user_id FOREIGN KEY (client_id) REFERENCES sf_guard_user(id);
ALTER TABLE sf_guard_forgot_password ADD CONSTRAINT sf_guard_forgot_password_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
